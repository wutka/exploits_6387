#include "target_lib.h"

int check_password();
void open_lock();


char *gets(char *);
int strcmp(char *c1, char *c2);

char prompt1[] = "Please enter lock password:";
char prompt2[] = "Invalid password, _ tries left:";

int main()
{
    init_term();

    if (check_password()) {
        open_lock();
    } else {
        write(1, "x", 1);
    }

    finish_term();
}

int check_password()
{
    char password[16];
    char is_password_valid;

    is_password_valid = 0;
    for (int i=0; !is_password_valid && (i < 3); i++) {
        if (i == 0) {
            prompt(prompt1, sizeof(prompt1), password);
        } else {
            prompt2[18] = '0' + (3-i);
            prompt(prompt2, sizeof(prompt2), password);
        }
        if (validate_password(password) == 1) {
            is_password_valid = 1;
            break;
        }
    }
    return is_password_valid;
}

void open_lock() {
    write(1, "!", 1);
}

