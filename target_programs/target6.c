#include "target_lib.h"

int check_password();
void open_lock();

char *gets(char *);
int strcmp(char *c1, char *c2);

char prompt1[] = "Please enter lock password:";
char prompt2[] = "Invalid password, _ tries left:";

char open_char = 'x';

int main()
{
    if (check_password()) {
        open_lock();
    } else {
        write(1, "x", 1);
    }
}

int check_password()
{
    char password[16];

    open_char = '!';
    for (int i=0; i < 3; i++) {
        if (i == 0) {
            prompt(prompt1, sizeof(prompt1), password);
        } else {
            prompt2[18] = '0' + (3-i);
            prompt(prompt2, sizeof(prompt2), password);
        }
        if (validate_password(password)) {
            return 1;
        }
    }
    open_char = 'x';
    return 0;
}

void open_lock() {
    write(1, &open_char, 1);
}

