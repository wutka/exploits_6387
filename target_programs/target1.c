#include "target_lib.h"

int check_password();
void open_lock();


char *gets(char *);
int strcmp(char *c1, char *c2);

char *pw = "@l0h0m0r@";

char prompt1[] = "Please enter lock password:\n";
char prompt2a[] = "Invalid password, ";
char prompt2b[] = " tries left:\n";

int main()
{
    if (check_password()) {
        open_lock();
    } else {
        write(2, "x", 1);
    }
}

int check_password()
{
    char password[16];
    char countstr[2];
    write(1, prompt1, sizeof(prompt1));
    for (int i=0; i < 3; i++) {
        write(2, "?", 1);
        gets(password);
        if (!strcmp(password, pw)) {
            return 1;
        }
        write(1, prompt2a, sizeof(prompt2a));
        countstr[0] = (2-i) + '0';
        countstr[1] = 0;
        write(1, countstr, 2);
        write(1, prompt2b, sizeof(prompt2b));
    }
    return 0;
}

void open_lock() {
    write(2, "!", 1);
}

