package main

import (
	"fmt"
	"github.com/wutka/exploits_6387/server"
)

func main() {
	sess, err := server.NewSession("target1")
	if err != nil {
		fmt.Printf("Error creating session: %+v", err)
		return
	}

	sess.Debug()
	memmap, err := sess.GetMemoryMap()
	fmt.Printf("%v\n", memmap)
	regs, err := sess.GetRegisters()
	fmt.Printf("%v\n", regs)
	_, _ = sess.Disassemble()

	_, _ = sess.GetMemory(memmap.ExecEnd, memmap.DataEnd)

	sess.End()
}
